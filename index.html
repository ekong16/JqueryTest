<html>
<head>
    <meta charset="utf-8">
    <title>Test</title>
    <link rel="stylesheet" href="styles.css"/>
</head>
   
<body>
    <script src="jquery.js"></script>
    
    <script type="text/javascript">
        var CANVAS_WIDTH = window.innerWidth*0.95;
        var CANVAS_HEIGHT = window.innerHeight*0.95;

        var canvasElement = $("<canvas width='" + CANVAS_WIDTH + 
                              "' height='" + CANVAS_HEIGHT + "'></canvas>");
        
        var canvas = canvasElement.get(0).getContext("2d");
        canvasElement.appendTo('body');
        var textX = 100;
        var textY = 100;
        var FPS = 60;
        
        var right = false;
        var up = false;
        var left = false;
        var down = false;
        var jumped = false;
        
        //Check if computer or mobile. Adds relevent event listeners --keyboard or touch. 
        if( /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {
            window.addEventListener('orientationchange', resizeCanvas, false);
            
            window.addEventListener('touchstart', function(e){
                e.preventDefault;
                if (!jumped){
                    up = true;
                    jumped = true;
                } else{up = false;}
            }, false);
            
            window.addEventListener('touchend', function(e){
                e.preventDefault;
                up = false; jumped = false;
            }, false);
            
            window.addEventListener('touchmove', function(e){
                e.preventDefault;
            },false);                          
        }
        else {
            window.addEventListener('resize', resizeCanvas, false);
            
            $(window).keydown(function(e){
                //alert("hi");
                switch(e.which) {
                        case 37: left = true; 
                        break;

                        case 32: if (!jumped) {up = true; jumped = true;} else{up=false;}
                        break;

                        case 39: right = true;
                        break;

                        case 40: down = true;
                        break;

                        default: return;

                }
                e.preventDefault();
            });

            $(window).keyup(function(e){
                switch(e.which) {
                        case 37: left = false; 
                        break;

                        case 32: up = false; jumped = false;
                        break;

                        case 39: right = false;
                        break;

                        case 40: down = false;
                        break;

                        default: return;
                }
            });
        }
        
        function resizeCanvas(){
            canvas.canvas.width = window.innerWidth*0.95;
            canvas.canvas.height = window.innerHeight*0.95;
        }
        
        function Sprite(x,y,w,h,img_src) {
            this.x = x;
            this.y = y;
            this.w = w;
            this.h = h;
            this.img = new Image(); 
            this.img.src = img_src;
            this.draw = function(){
                canvas.drawImage(this.img, this.x,this.y,this.w,this.h);
            }; 
        }
            
        function Character(x,y,w,h,img_src) {
            var t = 0;
            Sprite.call(this,x,y,w,h,img_src);
            this.yVel = 0;
            this.move = function(){
                if (up) {this.yVel=10; this.y-=10;}
                if (down) {t=0; this.y+=1;}
                if (left) {t=0; this.x--}
                if (right) {t=0; this.x++}
              
                if (!up && !down && !left && !right){ 
                    if (this.y + this.h - this.yVel >= canvas.canvas.height){
                        this.y = canvas.canvas.height - this.h;
                    }
                    else {
                        this.y -= this.yVel; 
                        this.yVel-=1;
                    } 
                }
            };
        }
        
        Character.prototype = Object.create(Sprite.prototype);
        
        var myChar = new Character(10,10,80,80,"fuzz.png");
        
        //found supposedly more efficient way to animate on internet
        window.requestAnimFrame = (function(){
            return window.requestAnimationFrame||
            window.webkitRequestAnimationFrame ||
            window.mozRequestAnimationFrame    ||
            window.oRequestAnimationFrame      || 
            window.msRequestAnimationFrame     || 
            function(callback){
                window.setTimeout(callback, 1000 / 60);
            };
        })();
        
        (function animloop(){
            requestAnimFrame(animloop);
            update();
            draw();
        })();
        
        function update(){
            textX += 1;
            textY += 1;
            myChar.move();
        }
       
        
        function draw(){
            canvas.clearRect(0,0,canvas.canvas.width,canvas.canvas.height);
            canvas.fillStyle = "#000"; // Set color to black
            canvas.font = "30px Arial";
            canvas.fillText("Sup!", textX, textY);
            myChar.draw();
        }
        
    </script>
    
</body>
    
</html>