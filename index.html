<html>
<head>
    <meta charset="utf-8">
    <title>Test</title>
    <link rel="stylesheet" href="styles.css"/>
</head>
   
<body>
    <script src="jquery.js"></script>
    <h1>Test for jQuery</h1>
    <script type="text/javascript">
        var CANVAS_WIDTH = window.innerWidth*0.9;
        var CANVAS_HEIGHT = window.innerHeight*0.8;

        var canvasElement = $("<canvas width='" + CANVAS_WIDTH + 
                              "' height='" + CANVAS_HEIGHT + "'></canvas>");
        
        var canvas = canvasElement.get(0).getContext("2d");
        canvasElement.appendTo('body');
        var textX = 100;
        var textY = 100;
        var FPS = 60;
        
        var right = false;
        var up = false;
        var left = false;
        var down = false;
        
        if( /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) ) {
            window.addEventListener('orientationchange', resizeCanvas, false);
            
        }
        else {
            window.addEventListener('resize', resizeCanvas, false);
            
            $(window).keydown(function(e){
                //alert("hi");
                keyboard = true;
                switch(e.which) {
                        case 37: left = true; 
                        break;

                        case 38: up = true;
                        break;

                        case 39: right = true;
                        break;

                        case 40: down = true;
                        break;

                        default: return;

                }
                    e.preventDefault();
            });

            $(window).keyup(function(e){
                switch(e.which) {
                        case 37: left = false; 
                        break;

                        case 38: up = false;
                        break;

                        case 39: right = false;
                        break;

                        case 40: down = false;
                        break;

                        default: return;
                }
            });
        }
        
        function resizeCanvas(){
            canvas.canvas.width = window.innerWidth*0.9;
            canvas.canvas.height = window.innerHeight*0.8;
        }
        
        

        
        function Sprite(x,y,w,h,img_src) {
            this.x = x;
            this.y = y;
            this.w = w;
            this.h = h;
            this.img = new Image(); 
            this.img.src = img_src;
            this.draw = function(){
                canvas.drawImage(this.img, this.x,this.y,this.w,this.h);
            }; 
        }
            
    
        
        function Character(x,y,w,h,img_src) {
            var t = 0;
            Sprite.call(this,x,y,w,h,img_src);
            this.move = function(){
                if (up) {t=0; this.y-=10;}
                if (down) {t=0; this.y+=1;}
                if (left) {t=0; this.x--}
                if (right) {t=0; this.x++}
              
                if (!up && !down && !left && !right){ 
                    if (this.y + this.h + t >= canvas.canvas.height){
                        this.y = canvas.canvas.height - this.h;
                    }
                    else {
                        this.y += t; 
                        t+=1;
                    } 
                }
            };
        }
        
         
        
        Character.prototype = Object.create(Sprite.prototype);
        
        var myChar = new Character(10,10,50,50,"http://www.wpclipart.com/smiley/assorted_smiley/assorted_2/fuzzball_smiley.svg");
        
        window.requestAnimFrame = (function(){
            return window.requestAnimationFrame||
            window.webkitRequestAnimationFrame ||
            window.mozRequestAnimationFrame    ||
            function(callback){
                window.setTimeout(callback, 1000 / 60);
            };
        })();
        
        (function animloop(){
            requestAnimFrame(animloop);
            update();
            draw();
        })();
        
        function update(){
            textX += 1;
            textY += 1;
            myChar.move();
        }
       
        
        function draw(){
            canvas.clearRect(0,0,canvas.canvas.width,canvas.canvas.height);
            canvas.fillStyle = "#000"; // Set color to black
            canvas.font = "30px Arial";
            canvas.fillText("Sup!", textX, textY);
            myChar.draw();
        }
        
    </script>
    
</body>
    
</html>